<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>学习助手 - 知识点管理系统</title>
    <script src="xlsx.full.min.js"></script>
    <script src="chart.js"></script>
    <script>
      window.MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']],
          displayMath: [['$$', '$$'], ['\\[', '\\]']],
          processEscapes: true,
          packages: {'[+]': ['textmacros']}
        },
        loader: {load: ['[tex]/textmacros']},
        options: {
          skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
          ignoreHtmlClass: 'tex-ignore'
        }
      };
    </script>
    <script src="Mathjax-3.2.0/es5/tex-mml-chtml.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <div class="logo-icon">知</div>
                <h1>学习助手 - 知识点管理系统</h1>
            </div>
            <div class="header-actions">
                <button class="btn" id="settingsBtn">
                    <i>⚙️</i> 设置
                </button>
            </div>
        </header>
        
        <!-- 工具栏 -->
        <div class="toolbar">
            <div class="toolbar-row">
                <div class="toolbar-group" id="library-management-group">
                    <span class="toolbar-group-label">题库管理:</span>
                    <button class="btn btn-primary" id="importBtn">
                        <i>📋</i> 导入
                    </button>
                    <button class="btn btn-success" id="addIdiomBtn">
                        <i>➕</i> 添加
                    </button>
                    <a href="#" id="downloadTemplate" class="btn">
                        <i>📝</i> 模板
                    </a>
                    <button class="btn btn-primary" id="exportBtn">
                        <i>📥</i> 导出
                    </button>
                </div>
                
                <div class="divider"></div>
                
                <div class="toolbar-group" id="learning-group">
                    <span class="toolbar-group-label">学习功能:</span>
                    <button class="btn btn-warning" id="learning-view-btn">
                        <i>🐤</i> 学习
                    </button>
                    <button class="btn btn-info" id="backToLibraryBtn">
                        <i>📚︎</i> 题库
                    </button>
                    <button class="btn btn-purple" id="stats-view-btn">
                        <i>📊</i> 统计
                    </button>
                </div>
            </div>
        </div>
        
        <!-- 知识点统计信息 -->
        <div class="knowledge-stats" id="knowledgeStats">
            <div class="stat-item">
                <span class="stat-label">标签统计:</span>
                <div class="tag-stats" id="tagStats">
                    <button class="tag-stat all-tag active">全部 (<span id="allTagCount">0</span>)</button>
                    <!-- 其他标签将通过JS动态生成 -->
                </div>
            </div>
            <div class="stat-item">
                <span class="stat-label">收藏统计:</span>
                <div class="stat-value" id="favoriteCount">0</div>
            </div>
        </div>
        
        <!-- 批量选择区域 - 只在题库视图显示 -->
        <div class="select-all-container" id="selectAllContainer">
            <input type="checkbox" id="selectAll" class="checkbox-input">
            <label for="selectAll">全选</label>
            <button class="batch-delete-btn" id="batchDeleteBtn">
                <i>🗑️</i> 批量删除
            </button>
            <button class="batch-reset-btn" id="batchResetBtn">
                <i>♻️</i> 批量重置
            </button>
            <!-- 标签重置功能已移除 -->
        </div>
        
        <div class="search-container" id="search-container">
            <input type="text" class="search-box" id="searchInput" placeholder="搜索知识点、释义或标签...">
            <div class="filter-btn" id="favoritesFilterBtn">
                <i>★</i> 仅收藏
            </div>
        </div>
        
        <!-- 题库管理视图 -->
        <div id="library-view" class="view-container active">
            <div class="idiom-list-container">
                <div class="scroll-hint">← 滑动查看完整表格 →</div>
                <table class="idiom-list" id="idiomTable">
                    <thead>
                        <tr>
                            <th class="checkbox-cell"><input type="checkbox" id="headerCheckbox" class="checkbox-input"></th>
                            <th width="15%" class="sortable-header" data-sort="text">知识点 <span class="sort-icon"></span></th>
                            <th width="40%">释义</th>
                            <th width="10%" class="sortable-header" data-sort="priority">优先级 <span class="sort-icon"></span></th>
                            <th width="10%" class="sortable-header" data-sort="studyCount">学习次数 <span class="sort-icon"></span></th>
                            <th width="20%">操作</th>
                        </tr>
                    </thead>
                    <tbody id="idiomListBody">
                        <!-- 知识点列表将通过JS动态生成 -->
                    </tbody>
                </table>
                <div class="empty-state" id="emptyState">
                    <div class="empty-state-icon">📚</div>
                    <div class="empty-state-text">知识点库为空，请添加知识点或导入数据</div>
                    <button class="btn btn-success" id="addFirstIdiomBtn">
                        <i>➕</i> 添加第一个知识点
                    </button>
                </div>
            </div>
        </div>
        
        <!-- 学习视图 -->
        <div id="learning-view" class="view-container">
            <!-- 学习恢复提示 -->
            <div class="resume-prompt" id="resumeLearningPrompt" style="display: none;">
                <h3>检测到未完成的学习进度</h3>
                <p>您有未完成的学习进度，是否继续上次的学习？</p>
                <div class="resume-progress" id="resumeProgress">
                    <div class="progress-bar" id="resumeProgressBar">进度：0/0</div>
                </div>
                <div class="resume-actions">
                    <button class="btn btn-success" id="resumeBtn">
                        <i>↻</i> 继续学习
                    </button>
                    <button class="btn btn-warning" id="newLearningBtn">
                        <i>🚀</i> 开始新学习
                    </button>
                </div>
            </div>
            
            <div class="study-section" id="studySection" style="display: none;">
                <div class="idiom-header" id="idiomHeader">
            <div class="progress-bar" id="progressBar">进度：0/0</div>
            <button class="btn btn-previous" id="previousBtn" style="display: none;">
                <i>←</i> 上一个
            </button>
            <button class="favorite-btn-study" id="favoriteBtnStudy">
                <i id="favoriteIcon">☆</i> 收藏
            </button>
            <button class="btn btn-finish" id="finishLearningBtn">
                <i>⏹️</i> 结束学习
            </button>
        </div>
                <div class="idiom-display" id="currentIdiom">守株待兔</div>
                <button class="show-meaning-btn" id="showMeaningBtn">显示释义</button>
                <div class="meaning-display" id="meaningDisplay" style="display: none;">
                    <div class="meaning-grid">
                        <div class="meaning-item" id="meaningItem">
                            <h3><i>📖</i> 释义</h3>
                            <p id="meaningText">比喻死守经验，不知变通</p>
                        </div>
                        <!-- 拼音显示区域 -->
                        <div class="meaning-item" id="pinyinItem">
                            <h3><i>🔊</i> 拼音</h3>
                            <p id="pinyinText">shǒu zhū dài tù</p>
                        </div>
                        <div class="meaning-item" id="exampleItem">
                            <h3><i>✏️</i> 例句</h3>
                            <p id="exampleText">我们不能有守株待兔的心理，要主动寻找机会。</p>
                        </div>
                        <div class="meaning-item" id="usageItem">
                            <h3><i>💡</i> 用法特点</h3>
                            <p id="usageText">多用于批评不主动努力、存侥幸心理的人</p>
                        </div>
                        <div class="meaning-item" id="contextItem">
                            <h3><i>🌐</i> 适用语境</h3>
                            <p id="contextText">消极、被动的情境</p>
                        </div>
                        <div class="meaning-item" id="fieldItem">
                            <h3><i>🔍</i> 解析</h3>
                            <p id="fieldText">教育、工作、生活</p>
                        </div>
                        <div class="meaning-item" id="tagsItem">
                            <h3><i>🏷️</i> 标签</h3>
                            <p id="tagsText">消极,被动</p>
                        </div>
                        <div class="meaning-item" id="notesItem">
                            <h3><i>📝</i> 备注</h3>
                            <p id="notesText">出自《韩非子·五蠹》</p>
                        </div>
                        <div class="meaning-item" id="statsItem">
                            <h3><i>📊</i> 学习数据</h3>
                            <p id="statsText">优先级: <span class="priority-badge priority-medium">中 (5)</span> | 学习次数: <span class="study-count-badge">3</span></p>
                        </div>
                        <div class="meaning-item" id="formulaItem">
                            <h3><i>Σ</i> 公式</h3>
                            <div class="formula-display" id="formulaDisplay"></div>
                        </div>
                        <div class="meaning-item" id="formulaCaseItem">
                            <h3><i>📐</i> 公式案例</h3>
                            <p id="formulaCase"></p>
                        </div>
                        <div class="meaning-item" id="formulaNoteItem">
                            <h3><i>📌</i> 公式备注</h3>
                            <p id="formulaNote"></p>
                        </div>
                        <!-- 收藏原因区域 -->
                        <div class="meaning-item" id="favoriteReasonItem" style="display: none;">
                            <h3><i>❤️</i> 收藏原因</h3>
                            <p id="favoriteReasonText"></p>
                        </div>
                    </div>
                </div>
                <div class="feedback-buttons" id="feedbackButtons" style="display: none;">
                    <button class="feedback-btn know-btn" data-feedback="know">
                        <i>✅</i> 认识
                    </button>
                    <button class="feedback-btn vague-btn" data-feedback="vague">
                        <i>❓</i> 模糊
                    </button>
                    <button class="feedback-btn forget-btn" data-feedback="forget">
                        <i>❌</i> 不认识
                    </button>
                </div>
                <!-- 优化后的学习完成模块 -->
                <div class="learning-complete" id="learningComplete">
                    <h3>🎉 学习完成！</h3>
                    <p>恭喜您完成了本轮学习！</p>
                    <div class="stats-summary">
                        <div class="stat-box">
                            <span class="stat-value" id="knowCount">0</span>
                            <span class="stat-label">认识</span>
                        </div>
                        <div class="stat-box">
                            <span class="stat-value" id="vagueCount">0</span>
                            <span class="stat-label">模糊</span>
                        </div>
                        <div class="stat-box">
                            <span class="stat-value" id="forgetCount">0</span>
                            <span class="stat-label">不认识</span>
                        </div>
                    </div>
                    <div class="action-buttons-complete">
                        <button class="btn btn-primary" id="restartLearningBtn">
                            <i>🔄</i> 重新开始学习
                        </button>
                        <button class="btn btn-info" id="backToLibraryAfterLearning">
                            <i>📚</i> 返回题库
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 统计视图 -->
        <div id="stats-view" class="view-container">
            <div class="stats-container">
                <h2 style="color: #4b6cb7; border-bottom: 2px solid #e2e8f0; padding-bottom: 10px; margin-bottom: 20px;">学习情况统计</h2>
                
                <div class="stats-grid">
                    <div class="stats-card">
                        <div class="stats-header">
                            <i>📊</i> 优先级分布
                        </div>
                        <div class="stats-chart">
                            <canvas id="priorityChart"></canvas>
                        </div>
                    </div>
                    
                    <div class="stats-card">
                        <div class="stats-header">
                            <i>📈</i> 记忆水平统计
                        </div>
                        <div class="stats-chart">
                            <canvas id="memoryLevelChart"></canvas>
                        </div>
                    </div>
                    
                    <div class="stats-card">
                        <div class="stats-header">
                            <i>📉</i> 优先级分布折线图
                        </div>
                        <div class="stats-chart" style="height: 300px;">
                            <canvas id="priorityDistributionChart"></canvas>
                        </div>
                    </div>

                    <div class="stats-card">
                        <div class="stats-header">
                            <i>📊</i> 学习次数分布折线图
                        </div>
                        <div class="stats-chart" style="height: 300px;">
                            <canvas id="studyCountDistributionChart"></canvas>
                        </div>
                    </div>

                    <div class="stats-card">
                        <div class="stats-header">
                            <i>🔍</i> 默认熟练度知识点学习情况
                        </div>
                        <div class="stats-chart">
                            <canvas id="priorityZeroStudyChart"></canvas>
                        </div>
                    </div>

                    <div class="stats-card">
                        <div class="stats-header">
                            <i>🏷️</i> 标签分布统计
                        </div>
                        <div class="stats-chart" style="height: 300px;">
                            <canvas id="tagDistributionChart"></canvas>
                        </div>
                    </div>
                    
                    <div class="stats-card">
                        <div class="stats-header">
                            <i>🔢</i> 优先级分布详情
                        </div>
                        <div class="priority-distribution" id="priorityDistribution">
                            <!-- 优先级分布详情将通过JS动态生成 -->
                        </div>
                    </div>
                    
                    <div class="stats-card">
                        <div class="stats-header">
                            <i>📚</i> 学习情况概览
                        </div>
                        <div style="margin: 15px 0;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                                <span>总知识点数:</span>
                                <span id="totalIdioms" style="font-weight: 600;">0</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                                <span>已掌握知识点:</span>
                                <span id="masteredIdioms" style="font-weight: 600; color: #0f9d58;">0</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                                <span>需复习知识点:</span>
                                <span id="needReviewIdioms" style="font-weight: 600; color: #f57c00;">0</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span>困难知识点:</span>
                                <span id="difficultIdioms" style="font-weight: 600; color: #db4437;">0</span>
                            </div>
                        </div>
                        <div class="suggestion-box">
                            <div class="stats-header">
                                <i>💡</i> 学习建议
                            </div>
                            <p id="learningSuggestion" style="margin-top: 10px; line-height: 1.5;">
                                根据您的学习情况，建议优先复习优先级较高的知识点。
                            </p>
                        </div>
                    </div>
                    
                    <!-- 学习记录卡片 -->
                    <div class="stats-card">
                        <div class="stats-header">
                            <i>📝</i> 学习记录
                        </div>
                        <p>以下是您的历史学习记录：</p>
                        <div class="record-chart-container" style="height: 300px;">
                        <canvas id="learningRecordsChart"></canvas>
                    </div>
                        <div class="records-container" id="learningRecordsContainer">
                            <!-- 学习记录将通过JS动态生成 -->
                        </div>
                        <button class="clear-records-btn" id="clearRecordsBtn">
                            <i>🗑️</i> 清除学习记录
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 通知容器 -->
    <div class="notification" id="notification"></div>
    
    <!-- 添加/编辑知识点模态框 -->
    <div class="modal" id="idiomModal">
        <div class="modal-content">
            <div class="modal-header" id="modalTitle">添加知识点
                <button class="close-modal" id="closeModalBtn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="idiomText"><i>📖</i> 知识点 *</label>
                    <input type="text" class="form-control" id="idiomText" placeholder="输入知识点" disabled>
                </div>
                <div class="form-group">
                    <label for="idiomPinyin"><i>🔊</i> 拼音 (可选)</label>
                    <input type="text" class="form-control" id="idiomPinyin" placeholder="输入拼音">
                </div>
                <div class="form-group">
                    <label for="idiomMeaning"><i>📝</i> 释义 * (支持LaTeX公式，内联公式使用 \\(...\\)，独立公式使用 \\[...\\])</label>
                    <textarea class="form-control" id="idiomMeaning" placeholder="输入释义" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label for="idiomExample"><i>✏️</i> 例句</label>
                    <textarea class="form-control" id="idiomExample" placeholder="输入例句" rows="2"></textarea>
                </div>
                <div class="form-group">
                    <label for="idiomUsage"><i>💡</i> 用法特点</label>
                    <input type="text" class="form-control" id="idiomUsage" placeholder="输入用法特点">
                </div>
                <div class="form-group">
                    <label for="idiomContext"><i>🌐</i> 适用语境</label>
                    <input type="text" class="form-control" id="idiomContext" placeholder="输入适用语境">
                </div>
                <div class="form-group">
                    <label for="idiomField"><i>🔍</i> 解析</label>
                    <input type="text" class="form-control" id="idiomField" placeholder="输入解析">
                </div>
                <div class="form-group">
                    <label for="idiomTags"><i>🏷️</i> 标签</label>
                    <input type="text" class="form-control" id="idiomTags" placeholder="输入标签，用逗号分隔">
                </div>
                <div class="form-group">
                    <label for="idiomNotes"><i>📌</i> 备注</label>
                    <textarea class="form-control" id="idiomNotes" placeholder="输入备注" rows="2"></textarea>
                </div>
                <!-- 公式输入区域 -->
                <div class="form-group">
                    <label for="idiomFormula"><i>Σ</i> 公式（LaTeX）</label>
                    <textarea class="form-control" id="idiomFormula" placeholder="输入LaTeX公式，例如：\\text{基期比重} = \\frac{\\frac{A}{1+a}}{\\frac{B}{1+b}} = \\frac{A}{B} \\times \\frac{1+b}{1+a}" rows="3"></textarea>
                    <p style="font-size: 12px; color: #718096; margin-top: 5px;">
                        提示：使用LaTeX语法输入数学公式，公式将在学习模式中渲染显示
                    </p>
                </div>
                <!-- 新增：公式案例输入区域 -->
                <div class="form-group">
                    <label for="idiomFormulaCase"><i>📐</i> 公式案例 (支持LaTeX公式)</label>
                    <textarea class="form-control" id="idiomFormulaCase" placeholder="输入公式案例（LaTeX）" rows="2"></textarea>
                </div>
                <!-- 新增：公式备注输入区域 -->
                <div class="form-group">
                    <label for="idiomFormulaNote"><i>📌</i> 公式备注 (支持LaTeX公式)</label>
                    <textarea class="form-control" id="idiomFormulaNote" placeholder="输入公式备注（LaTeX）" rows="2"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn" id="cancelBtn">取消</button>
                <button class="btn btn-success" id="saveIdiomBtn">保存</button>
            </div>
        </div>
    </div>
    
    <!-- 查看知识点模态框 -->
    <div class="modal" id="viewModal">
        <div class="modal-content view-idio-modal">
            <div class="modal-header" id="viewModalTitle">查看知识点详情
                <button class="close-modal" id="closeViewModalBtn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="meaning-grid" id="viewMeaningGrid">
                    <div class="meaning-item">
                        <h3><i>📖</i> 知识点</h3>
                        <p id="viewText">守株待兔</p>
                    </div>
                    <div class="meaning-item">
                        <h3><i>🔊</i> 拼音</h3>
                        <p id="viewPinyin">shǒu zhū dài tù</p>
                    </div>
                    <div class="meaning-item">
                        <h3><i>📝</i> 释义</h3>
                        <p id="viewMeaning">比喻死守经验，不知变通</p>
                    </div>
                    <div class="meaning-item">
                        <h3><i>✏️</i> 例句</h3>
                        <p id="viewExample">我们不能有守株待兔的心理，要主动寻找机会。</p>
                    </div>
                    <div class="meaning-item">
                        <h3><i>💡</i> 用法特点</h3>
                        <p id="viewUsage">多用于批评不主动努力、存侥幸心理的人</p>
                    </div>
                    <div class="meaning-item">
                        <h3><i>🌐</i> 适用语境</h3>
                        <p id="viewContext">消极、被动的情境</p>
                    </div>
                    <div class="meaning-item">
                        <h3><i>🔍</i> 解析</h3>
                        <p id="viewField">教育、工作、生活</p>
                    </div>
                    <div class="meaning-item">
                        <h3><i>🏷️</i> 标签</h3>
                        <p id="viewTags">消极,被动</p>
                    </div>
                    <div class="meaning-item">
                        <h3><i>📝</i> 备注</h3>
                        <p id="viewNotes">出自《韩非子·五蠹》</p>
                    </div>
                    <div class="meaning-item">
                        <h3><i>📊</i> 学习数据</h3>
                        <p id="viewStats">优先级: <span class="priority-badge priority-medium">中 (5)</span> | 学习次数: <span class="study-count-badge">3</span></p>
                    </div>
                    <div class="meaning-item" id="viewFormulaItem">
                        <h3><i>Σ</i> 公式</h3>
                        <div class="formula-display" id="viewFormulaDisplay"></div>
                    </div>
                    <!-- 新增：公式案例显示区域 -->
                    <div class="meaning-item" id="viewFormulaCaseItem">
                        <h3><i>📐</i> 公式案例</h3>
                        <p id="viewFormulaCase"></p>
                    </div>
                    <!-- 新增：公式备注显示区域 -->
                    <div class="meaning-item" id="viewFormulaNoteItem">
                        <h3><i>📌</i> 公式备注</h3>
                        <p id="viewFormulaNote"></p>
                    </div>
                    <!-- 收藏原因显示区域 -->
                    <div class="meaning-item" id="viewFavoriteReasonItem" style="display: none;">
                        <h3><i>❤️</i> 收藏原因</h3>
                        <p id="viewFavoriteReason"></p>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" id="closeViewBtn">关闭</button>
            </div>
        </div>
    </div>
    
    <!-- 导入模态框 -->
    <div class="modal" id="importModal">
        <div class="modal-content">
            <div class="modal-header">导入Excel数据
                <button class="close-modal" id="closeImportModalBtn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>请选择Excel文件（.xlsx格式）</label>
                    <input type="file" id="excelFile" accept=".xlsx, .xls">
                </div>
                <div class="form-group">
                    <label style="color: #0288d1; font-weight: normal; background: #e6f7ff; padding: 10px; border-radius: 8px;">
                        <i>ℹ️</i> 提示: 
                        <ul style="margin: 10px 0 0 20px; padding-left: 10px;">
                            <li>"知识点"和"释义"列是必需的</li>
                            <li>"拼音"列是可选的</li>
                            <li>"优先级"和"学习次数"列不是必需的，如果没有则默认为0</li>
                            <li>其他列都是可选的，包括"公式"、"公式案例"和"公式备注"列</li>
                            <li>新增"收藏"和"收藏原因"列支持导入</li>
                            <li>释义中的LaTeX公式需要用\\(...\\)或\\[...\\]包裹</li>
                        </ul>
                    </label>
                </div>
                <div class="import-progress" id="importProgress">
                    导入进度：<span id="progressText">0</span>
                </div>
                <div class="import-details" id="importDetails" style="display: none;">
                    <!-- 导入详情将通过JS动态生成 -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn" id="cancelImportBtn">取消</button>
                <button class="btn btn-primary" id="confirmImportBtn" disabled>导入</button>
            </div>
        </div>
    </div>
    
    <!-- 批量删除确认模态框 -->
    <div class="modal" id="batchDeleteModal">
        <div class="modal-content">
            <div class="modal-header">确认删除
                <button class="close-modal" id="closeBatchDeleteModalBtn">&times;</button>
            </div>
            <div class="modal-body">
                <p>确定要删除选中的知识点吗？此操作不可撤销。</p>
                <p id="deleteCountText">已选择 <span id="selectedCount">0</span> 个知识点</p>
            </div>
            <div class="modal-footer">
                <button class="btn" id="cancelBatchDeleteBtn">取消</button>
                <button class="btn btn-danger" id="confirmBatchDeleteBtn">确认删除</button>
            </div>
        </div>
    </div>

    <!-- 批量重置确认模态框 -->
    <div class="modal" id="batchResetModal">
        <div class="modal-content">
            <div class="modal-header">确认重置
                <button class="close-modal" id="closeBatchResetModalBtn">&times;</button>
            </div>
            <div class="modal-body">
                <p>确定要将选中的知识点优先级重置为 0 吗？此操作不可撤销。</p>
                <p id="resetCountText">已选择 <span id="selectedResetCount">0</span> 个知识点</p>
            </div>
            <div class="modal-footer">
                <button class="btn" id="cancelBatchResetBtn">取消</button>
                <button class="btn btn-warning" id="confirmBatchResetBtn">确认重置</button>
            </div>
        </div>
    </div>

    <!-- 标签重置模态框已移除 -->

    <!-- 设置模态框 -->
    <div class="modal" id="settingsModal">
        <div class="modal-content">
            <div class="modal-header">设置
                <button class="close-modal" id="closeSettingsModalBtn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label><i>🌙</i> 夜间模式</label>
                    <div>
                        <label style="display:flex;align-items:center;gap:8px;">
                            <input type="checkbox" id="nightModeToggle"> 启用夜间模式
                        </label>
                    </div>
                </div>
                <div class="form-group">
                    <label><i>📅</i> 学习进度设置</label>
                    <div>
                        <label style="display:flex;align-items:center;gap:8px;">
                            <input type="checkbox" id="clearProgressNextDayToggle"> 次日清除学习进度
                        </label>
                        <small style="color: #64748b; display:block; margin-top:5px;">启用后，当天的学习进度将在次日打开应用时自动清除</small>
                    </div>
                </div>
                <div class="form-group">
                    <label><i>🎯</i> 学习词库范围</label>
                    <div style="display:flex;flex-direction:column;gap:8px;">
                        <label><input type="radio" name="studyScope" id="studyScopeAll" value="all" checked> 学习全部知识点</label>
                        <label><input type="radio" name="studyScope" id="studyScopeTags" value="tags"> 按标签选择</label>
                        <div id="settingsTagList" style="margin-left: 16px; display:none; gap:8px; flex-wrap:wrap;"></div>
                    </div>
                </div>
                <div class="form-group">
                    <label><i>🔤</i> 学习界面字体大小</label>
                    <div style="display:flex;gap:12px;">
                        <label><input type="radio" name="fontSize" id="fontSizeSmall" value="small"> 小</label>
                        <label><input type="radio" name="fontSize" id="fontSizeMedium" value="medium" checked> 中</label>
                        <label><input type="radio" name="fontSize" id="fontSizeLarge" value="large"> 大</label>
                    </div>
                </div>
                <div class="form-group">
                    <label><i>⚖️</i> 优先级调整（认识/模糊/不认识）</label>
                    <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap;">
                        <span>认识</span>
                        <input type="number" id="priorityKnow" class="form-control" style="width:80px;" value="-2">
                        <span>模糊</span>
                        <input type="number" id="priorityVague" class="form-control" style="width:80px;" value="1">
                        <span>不认识</span>
                        <input type="number" id="priorityForget" class="form-control" style="width:80px;" value="3">
                    </div>
                </div>
                <div class="form-group">
                    <label><i>🧹</i> 重置</label>
                    <div>
                        <button class="btn btn-danger" id="resetProgressInSettingsBtn"><i>🔄</i> 重置进度</button>
                    </div>
                </div>
                <div class="form-group">
                    <label><i>ℹ️</i> 关于</label>
                    <div style="color:#718096;display:flex;gap:20px;flex-wrap:wrap;">
                        <span>版本：<strong id="appVersion">-</strong></span>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn" id="cancelSettingsBtn">取消</button>
                <button class="btn btn-success" id="saveSettingsBtn">保存设置</button>
            </div>
        </div>
    </div>
    
    <script src="script.js"></script>
</body>
</html>